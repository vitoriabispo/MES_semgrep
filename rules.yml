rules:
  - id: enforce-requests-timeout-hf
    languages: [python]
    message: "Toda chamada a biblioteca `requests` deve ter um `timeout` definido para evitar que a aplicação trave esperando a API do Hugging Face. Ex: `requests.get(url, timeout=10)`."
    severity: WARNING
    patterns:
      - pattern-not-inside: requests.$METHOD(... , timeout=..., ...)
      - pattern: requests.$METHOD(...)

  - id: check-vulnerable-pyyaml
    languages: [generic]
    message: "A versão 5.0 do PyYAML é vulnerável à Execução de Código Remoto (CVE-2017-18342). Use uma versão >= 5.1. Ferramentas de SCA automatizam essa verificação."
    severity: ERROR
    patterns:
      - pattern-regex: (?i)PyYAML(==|<=)5\.0
    paths:
      include:
        - "requirements.txt"